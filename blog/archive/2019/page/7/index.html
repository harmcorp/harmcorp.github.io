
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://harmcorp.github.io/blog/archive/2019/page/7/">
      
      
        <link rel="prev" href="../../../2025/">
      
      
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.2">
    
    
      
        <title>2019 - HARM CORP</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.d7758b05.min.css">
      
      


  
  
    
    
      
    
    
  
  
  <style>.md-tag.md-tag--rabbitmq{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.035 9.601h-7.677a.956.956 0 0 1-.962-.962V.962a.956.956 0 0 0-.962-.956H10.56a.956.956 0 0 0-.962.956V8.64a.956.956 0 0 1-.962.962H5.762a.956.956 0 0 1-.961-.962V.962A.956.956 0 0 0 3.839 0H.959a.956.956 0 0 0-.956.962v22.076A.956.956 0 0 0 .965 24h22.07a.956.956 0 0 0 .962-.962V10.58a.956.956 0 0 0-.962-.98zm-3.86 8.152a1.437 1.437 0 0 1-1.437 1.443h-1.924a1.437 1.437 0 0 1-1.436-1.443v-1.917a1.437 1.437 0 0 1 1.436-1.443h1.924a1.437 1.437 0 0 1 1.437 1.443z"/></svg>');}</style>

    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#2019" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="HARM CORP" class="md-header__button md-logo" aria-label="HARM CORP" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            HARM CORP
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              2019
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="HARM CORP" class="md-nav__button md-logo" aria-label="HARM CORP" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    HARM CORP
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    this is blog index!
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tags
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_3" checked>
        
          
          <label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Archive
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_3">
            <span class="md-nav__icon md-icon"></span>
            Archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../2025/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2025
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
      
    
  
  
    <li class="md-nav__item">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="../../" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    2019
    
  </span>
  

      </a>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4" >
        
          
          <label class="md-nav__link" for="__nav_1_4" id="__nav_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Categories
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4">
            <span class="md-nav__icon md-icon"></span>
            Categories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/holidays/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Holidays
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content" data-md-component="content">
    <div class="md-content__inner">
      <header class="md-typeset">
        <h1 id="2019">2019</h1>
      </header>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2019-07-30 00:00:00+00:00">July 30, 2019</time></li>
        
        
          
          <li class="md-meta__item">
            
              1 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="builder-pattern"><a class="toclink" href="../../../../2019/07/30/builder-pattern/">Builder Pattern</a></h2>
<ul>
<li>객체를 생성 시, 초기화 할 변수가 많으면..</li>
<li>생성자로 받는 방식<ul>
<li>파라미터가 많아지면, 파라미터간 식별이 힘들어짐.</li>
<li>다양한 파라미터를 받는 생성자가 필요할 수도 있음.</li>
<li>그럼 생성자가 많아지고, 위와 같은 문제(파라미터간 식별불가)가 또 발생할 수 있음.</li>
</ul>
</li>
<li>setter 로 받는 방식.<ul>
<li>객체 안의 변수가 언제든 바뀔 수 있는 가능성이 존재.</li>
</ul>
</li>
</ul>
<p>위의 문제를 해결하기 위해 나온 디자인 패턴인 것 같다.
우아한 불변객체생성과 변수 초기화의 가독성을 해결.</p>
<p>예제. <code>String</code> 타입의 불변의 멤버변수 3개 (<code>innerId</code>, <code>innerName</code>, <code>innerAlias</code>) 를 갖는 <code>SchemaObject003001</code> class</p>
<blockquote>
<p>jaxb schema object 로 사용하던 클래스라 명칭이 좀 더럽다.</p>
<p>내부 <code>Builder</code> class 의 생성자에 필수 멤버변수를 둘 수도 있고, (그때는 해당 멤버변수를 final 로 선언)</p>
<p>빌더 패턴으로 변수 초기화 시 변수 값을 validation 할 수도 있다.</p>
</blockquote>
<pre><code class="language-java">public class SchemaObject003001 {
    private final String innerId;
    private final String innerName;
    private final String innerAlias;
    public static class Builder {
        private String innerId;
        private String innerName;
        private String innerAlias;
        public Builder innerId(String innerId) {
            this.innerId = innerId;
            return this;
        }
        public Builder innerName(String innerName) {
            this.innerName = innerName;
            return this;
        }
        public Builder innerAlias(String innerAlias) {
            this.innerAlias = innerAlias;
            return this;
        }
        public SchemaObject003001 build() {
            return new SchemaObject003001(this);
        }
    }
    private SchemaObject003001(Builder builder) {
        this.innerId = builder.innerId;
        this.innerName = builder.innerName;
        this.innerAlias = builder.innerAlias;
    }
    public String getInnerId() {
        return innerId;
    }

    public String getInnerName() {
        return innerName;
    }

    public String getInnerAlias() {
        return innerAlias;
    }
}
</code></pre>
<pre><code class="language-java">
SchemaObject003001 so = new SchemaObject003001
  .Builder()
  .innerId(&quot;inner-id1&quot;)
  .innerName(&quot;inner-name1&quot;)
  .innerAlias(&quot;inner-alias1&quot;)
  .build();

</code></pre>
<ul>
<li><a href="https://johngrib.github.io/wiki/builder-pattern/">참고자료1</a></li>
</ul>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2019-07-29 00:00:00+00:00">July 29, 2019</time></li>
        
        
          
          <li class="md-meta__item">
            
              4 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="docker"><a class="toclink" href="../../../../2019/07/29/docker-%EA%B8%B0%EC%B4%88/">Docker 기초</a></h2>
<p><img alt="많이 보던 그 그림" src="/assets/images/posts/2019-07-29-docker.jpg" /></p>
<p><a href="https://docs.docker.com/">Docker document</a></p>
<p><code>docker</code> vs <code>vm</code> 이라기보단 <code>container</code> vs <code>vm</code> 이라고 해야한다.
<code>docker</code> 는 많은 <code>container</code> 기술 중 하나이다.
<code>vm</code> 은 <code>hypervisor</code> 로 하드웨어 가상화를 한 뒤에 <code>guest OS</code> 를 올리고, 그 위에 <code>application</code> 이 필요한 <code>bins/lib</code> 가 올라 간다.</p>
<blockquote>
<p>따라서 격리화 수준이 높고
 - 보안 수준이 높다. (하나의 vm 이 뚫려도 host 는 안전하다.)
 - 완전 다른 os 를 올릴 수 있다.</p>
<p>application 까지 io 처리를 하기 위한 커널단계가 많다.
  - 느리다</p>
</blockquote>
<p><code>application</code> 마다 <code>guest OS</code> 가 필요하기 때문에 용량이 크다. &gt;&gt; 배포시 고려요소</p>
<blockquote>
<p><code>docker</code> 를 알게된지 얼마 안됐지만, 몇달마다 문서가 바뀌는걸 보니 좀 당황스럽다..
설치 방법도 써놓으려고 했는데 문서가 자꾸 바뀌네 ㅠㅠ
<code>docker</code> group 에 <code>linux user</code> 를 추가해야 <code>root</code> 권한 없이 <code>docker</code> 를 실행할 수 있다.</p>
</blockquote>
<p>docker 의 Images, containers, volumes, or customized configuration files 들이 저장되는 장소</p>
<pre><code>/var/lib/docker
</code></pre>
<h3 id="docker-image-build"><a class="toclink" href="../../../../2019/07/29/docker-%EA%B8%B0%EC%B4%88/#docker-image-build">docker image build</a></h3>
<p><code>docker file</code> 로 <code>docker images</code> 를 만든다.</p>
<pre><code class="language-shell">$ docker build -t [REPO/IMAGE_NAME]:[IMAGE_TAG] [DOCKER FILE LOCATION]
$ docker build -t [REPO/IMAGE_NAME]:[IMAGE_TAG] (-f [DOCKER FILE NAME]) [DOCKER FILE LOCATION]

#-t : tag
$ docker build -t test-redis:0.1 .

#-f : docker&quot;f&quot;ile
#--cidfile=&quot;container_id_file_path&quot; : write container id to file
$ docker build -t was:0.1 .
$ docker build -t was:0.2 -f DockerfileForWas02 .
</code></pre>
<h3 id="dockerfile-example"><a class="toclink" href="../../../../2019/07/29/docker-%EA%B8%B0%EC%B4%88/#dockerfile-example">Dockerfile example</a></h3>
<pre><code>FROM alpine:3.10

LABEL maintainer=&quot;herdin86@gmail.com&quot;

RUN apk add git
RUN apk add openjdk11
RUN mkdir /msa
COPY ./build/libs/GradleSpringBootMybatis-1.0-SNAPSHOT.jar /msa

CMD [&quot;java&quot;, &quot;-jar&quot;, &quot;/msa/GradleSpringBootMybatis-1.0-SNAPSHOT.jar&quot;]
</code></pre>
<ul>
<li>FROM: 도커 파일을 만들 베이스이미지를 지정한다.</li>
<li>LABEL</li>
<li>RUN</li>
<li>ADD</li>
<li>COPY</li>
<li>
<p>ADD 와 COPY 의 차이점</p>
<ul>
<li>URL을 복사할 source로 사용할 수 있다. remote에 있는 파일을 받아서 복사하게 된다.</li>
<li>source 파일이 gzip과 같이 일반적으로 잘 알려진 압축형태인 경우, 압축을 풀어준다.</li>
<li>압축된 remote 파일인 경우, 압축을 풀어주지는 않는다.</li>
<li>ADD 보다 RUN 으로 작업을 할 경우, 더 명시적이고 이미지가 더 작아진다고한다.<blockquote>
<p>ADD 대신 COPY 와 RUN 을 사용하자.</p>
</blockquote>
</li>
</ul>
</li>
<li>
<p>출처</p>
<ul>
<li><a href="https://nickjanetakis.com/blog/docker-tip-2-the-difference-between-copy-and-add-in-a-dockerile">Docker Tip #2: The Difference between COPY and ADD in a Dockerfile</a></li>
<li><a href="https://blog.leocat.kr/notes/2017/01/07/docker-add-vs-copy">[Docker] ADD vs COPY in Dockerfile</a></li>
</ul>
</li>
</ul>
<h3 id="cmd-entrypoint"><a class="toclink" href="../../../../2019/07/29/docker-%EA%B8%B0%EC%B4%88/#cmd-entrypoint">CMD 와 ENTRYPOINT 의 차이점</a></h3>
<p>ENTRYPOINT 의 명령어는 변경되지 않는다.
CMD 는 컨테이너 생성 시 명령어를 변경할 수 있다.</p>
<pre><code class="language-shell"># 아래와 같은 두 파일이 있을 경우,
cat &lt;&lt;EOF &gt; DockerfileCMD
FROM alpine
CMD [&quot;echo&quot;, &quot;hello, cmd&quot;]
EOF

cat &lt;&lt;EOF &gt; DockerfileENTRY
FROM alpine
ENTRYPOINT [&quot;echo&quot;, &quot;hello, entrypoint&quot;]
EOF

# 이미지 생성
$ docker build -t test:cmd -f DockerfileCMD .
$ docker build -t test:entry -f DockerfileENTRY .

# 실행
$ docker run --name test-cmd test:cmd echo wow
$ docker run --name test-entry test:entry echo wow
# 재실행
$ docker start test-cmd
$ docker start test-entry

$ docker logs test-cmd
wow
wow

$ docker logs test-entry
hello, entrypoint echo wow
hello, entrypoint echo wow
</code></pre>
<h3 id="docker-image-commit"><a class="toclink" href="../../../../2019/07/29/docker-%EA%B8%B0%EC%B4%88/#docker-image-commit">docker image commit</a></h3>
<p><code>container</code> 로 부터 <code>images</code> 를 만든다.</p>
<pre><code class="language-shell">$ docker commit (-a &quot;[AUTHOR_INFO]&quot;) (-c &quot;[COMMENT]&quot;) [CONTAINER_ID/NAME] [REPO/IMAGE_NAME]:[IMAGE_TAG]

$ docker commit -a &quot;epu baal &lt;herdin86@gmail.com&gt;&quot; -c &quot;new images&quot; devwas02 newdevwas:0.1
</code></pre>
<h3 id="docker-images-tag"><a class="toclink" href="../../../../2019/07/29/docker-%EA%B8%B0%EC%B4%88/#docker-images-tag">docker images tag</a></h3>
<p><code>remote repository</code> 에서 사용할 <code>tag</code> 를 저장한다.</p>
<pre><code class="language-shell">$ docker tag [DOCKER_IMAGE_NAME]:[IMAGE_VERSION] [IMAGE_REPOSITORY_URL]:[IMAGE_VERSION_IN_REPOSITORY]

$ docker tag web:0.1 123456789012.dkr.ecr.ap-northeast-2.amazonaws.com/myweb01:0.1
</code></pre>
<h3 id="docker-image-push"><a class="toclink" href="../../../../2019/07/29/docker-%EA%B8%B0%EC%B4%88/#docker-image-push">docker image push</a></h3>
<p><code>remote repository</code> 로 <code>image</code> 를 전송한다.</p>
<pre><code class="language-shell">$ docker push [IMAGE_REPOSITORY_URL]:[IMAGE_VERSION_IN_REPOSITORY]

$ docker push 546552822736.dkr.ecr.ap-northeast-2.amazonaws.com/herdinecr01:0.1
</code></pre>
<h3 id="docker-image-rmi-remove-image"><a class="toclink" href="../../../../2019/07/29/docker-%EA%B8%B0%EC%B4%88/#docker-image-rmi-remove-image">docker image rmi (remove image)</a></h3>
<p><code>docker images</code> 를 삭제한다.</p>
<pre><code class="language-shell">$ docker rmi [REPO/IMAGE_NAME]:[IMAGE_TAG] #remove image

$ docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
elevator            0.4                 0f06f1b3604e        About an hour ago   885MB
elevator            0.3                 d0e16464a89f        10 days ago         874MB
elevator            0.2                 367e2c8e5b19        10 days ago         873MB
elevator            0.1                 6bc1755dfb94        10 days ago         874MB
alpine              latest              b7b28af77ffe        4 weeks ago         5.58MB
redis               4-alpine            8ce91e22cd3f        3 months ago        35.5MB
vault               1.1.2               8a23297b2305        3 months ago        108MB
centos              latest              9f38484d220f        4 months ago        202MB
golang              1.10                6fd1f7edb6ab        6 months ago        760MB
$ docker rmi centos:latest #delete with image-name:tag
Untagged: centos:latest
Untagged: centos@sha256:a799dd8a2ded4a83484bbae769d97655392b3f86533ceb7dd96bbac929809f3c
Deleted: sha256:9f38484d220fa527b1fb19747638497179500a1bed8bf0498eb788229229e6e1
Deleted: sha256:d69483a6face4499acb974449d1303591fcbb5cdce5420f36f8a6607bda11854

$ docker rmi b7b28af77ffe #delete with image-id
Untagged: alpine:latest
Untagged: alpine@sha256:6a92cd1fcdc8d8cdec60f33dda4db2cb1fcdcacf3410a8e05b3741f44a9b5998
Deleted: sha256:b7b28af77ffec6054d13378df4fdf02725830086c7444d9c278af25312aa39b9
Deleted: sha256:1bfeebd65323b8ddf5bd6a51cc7097b72788bc982e9ab3280d53d3c613adffa7
</code></pre>
<h3 id="docker-container-runstopstartexeclogskillpsrm"><a class="toclink" href="../../../../2019/07/29/docker-%EA%B8%B0%EC%B4%88/#docker-container-runstopstartexeclogskillpsrm">docker container run/stop/start/exec/logs/kill/ps/rm</a></h3>
<pre><code class="language-shell">docker run [REPO/IMAGE_NAME]:[IMAGES_TAG]
#-d : detach mode, deamonize
#-p [HOST PORT]:[CONTAINER PORT]: port mapping -&gt; old syntax
#--publish published=[HOST PORT],target=[CONTAINER PORT] -&gt; new syntax
#--name : container name
#--restart=no/on-failure[:max-retries]/always/unless-stopped : restart policy
#--cap-add : Add Linux capabilities
#ex) docker run -d -p 8081:8080 --name was01 was:0.1
</code></pre>
<p><code>--cap-add</code> : 컨테이너에서 cgroups의 특정 Capability를 사용합니다. ALL을 지정하면 모든 Capability 를 사용합니다. <a href="http://pyrasis.com/book/DockerForTheReallyImpatient/Chapter20/28">출처</a><br />
여기서 모든 Capability 는 <a href="https://linux.die.net/man/7/capabilities">여기서</a> 볼 수 있다.  </p>
<blockquote>
<p>그럼 Capability 는 뭘까? ㅠㅠ ㅎ그흑 <a href="https://access.redhat.com/documentation/ko-kr/red_hat_enterprise_linux/6/html/resource_management_guide/ch01">참고</a></p>
</blockquote>
<pre><code class="language-shell">docker ps
#-a : all, default
#-f : filter : status=exited/running, status=exited/running/...

docker start [CONTAINER_ID/ID_PREFIX/NAME]
docker logs [CONTAINER_ID/ID_PREFIX/NAME]
docker stop [CONTAINER_ID/ID_PREFIX/NAME] #send stop signal
docker kill [CONTAINER_ID/ID_PREFIX/NAME]
docker rm [CONTAINER_ID/ID_PREFIX/NAME]

docker exec -it [CONTAINER_NAME] [COMMANDS..]
#ex) docker exec -it was01 /bin/bash
</code></pre>
<h3 id="docker-volume"><a class="toclink" href="../../../../2019/07/29/docker-%EA%B8%B0%EC%B4%88/#docker-volume">docker volume</a></h3>
<p><code>docker</code> 에서 사용하는 <code>volume</code> 관련된 명령어들.</p>
<pre><code class="language-shell">docker volume ls #volume list
docker volume inspect [DOCKER_VOLUME_NAME]
docker volume rm $(docker volume ls -f dangling=true -q) #remove dangling volume
#or using 1.13.x
docker volume prune #remove dangling volume
</code></pre>
<h3 id="docker-daemon-config"><a class="toclink" href="../../../../2019/07/29/docker-%EA%B8%B0%EC%B4%88/#docker-daemon-config">docker daemon config</a></h3>
<ul>
<li>docker 는 container 에서 stdout 으로 나오는 출력을 특정 위치 <code>/var/lib/docker/containers/{containerID}</code> 에 파일로 쌓는다</li>
<li>기본으로 logrotate 를 하지 않는다!</li>
<li>기본 config 위치: <code>/etc/docker/daemon.json</code></li>
<li>다른 config 위치를 사용하고싶다면 dockerd 명령어로 --config-file 옵션을 줘야하는듯?</li>
</ul>
<pre><code class="language-bash"># validate config file
$ dockerd --validate --config-file=/tmp/valid-config.json


$ cat &lt;&lt;EOF &gt; daemon.json
{
  &quot;log-driver&quot;: &quot;json-file&quot;,
  &quot;log-opts&quot;: {
    &quot;max-size&quot;: &quot;1m&quot;,
    &quot;max-file&quot;: &quot;3&quot;
  }
}
EOF

</code></pre>
<h3 id="_1"><a class="toclink" href="../../../../2019/07/29/docker-%EA%B8%B0%EC%B4%88/#_1">참고</a></h3>
<ul>
<li><a href="https://www.44bits.io/ko/post/how-docker-image-work">만들면서 이해하는 도커(Docker) 이미지의 구조</a></li>
<li><a href="https://docs.docker.com/engine/logging/configure/#configure-the-default-logging-driver">Configure the default logging driver</a></li>
<li><a href="https://docs.docker.com/reference/cli/dockerd/#daemon-configuration-file">Daemon configuration file</a></li>
</ul>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2019-07-29 00:00:00+00:00">July 29, 2019</time></li>
        
        
          
          <li class="md-meta__item">
            
              1 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="promise"><a class="toclink" href="../../../../2019/07/29/promise-%EA%B0%80-%EB%AD%90%EC%A7%80/">Promise 가 뭐지</a></h2>
<p><code>ECMA Script 6</code> 부터 <code>native Promise</code> 를 지원한다.</p>
<p><code>callback hell</code> 을 타파하기 위한 패턴, 클래스로 우아하고 가독성 좋은 코드를 만들도록 한다.</p>
<p>Promise 의 4가지 상태
- pending 대기중
- fulfilled 이행성공
- rejected 이행실패
- settled 종료</p>
<blockquote>
<p>아래의 예제는 <code>PromiseLogger</code> class 를 디버깅용도로 사용하고
<code>init()</code>, <code>process()</code> 함수가  10번의 <code>call chain</code> 을 갖는다.
별로 의미있는 예제라기보다 이렇게 사용하면 된다를 기록하고 싶었다.</p>
</blockquote>
<p>{% highlight javascript %}
class PromiseLogger {
  constructor() {
    this.debug = true;
    this.debuglog = function(data) {
      if(this.debug) {
        console.log(data);
      }
    }
    this.debugdir = function(data) {
      if(this.debug) {
        console.dir(data);
      }
    }
  }
}</p>
<p>var logger = new PromiseLogger();</p>
<p>function init(data) {
  logger.debuglog('init() start : ' + data.init + ' : ' + data.data + ' : ' + data.log);
  return new Promise(function(resolve, reject) {
    if(data.init == true) {
      logger.debuglog('init() resolve');
      data.data = data.data + 1;
      data.log = data.log + ' : init added';
      data.process = (i%3==0);
      //언제 끝날지 모르는 일..
      resolve(data);
    } else {
      logger.debuglog('init() reject');
      reject(data);
    }
  });
}</p>
<p>function process(data) {
  return new Promise(function(resolve, reject) {
    logger.debuglog('process() start : ' + data.init + ' : ' + data.data + ' : ' + data.log);
    if(data.process == true) {
      logger.debuglog('process() resolve');
      data.data = data.data + 1;
      data.log = data.log + ' : process added';
      //언제 끝날지 모르는 일..
      resolve(data);
    } else {
      logger.debuglog('process() reject');
      reject(data);
    }
  });
}</p>
<p _="%" endhighlight="endhighlight">var tPromise, i;
for(i=0; i&lt;10; i++) {
  tPromise = init({data:i, log:'start'+i, init:(i%2==0)})
  .then(process)
  .then(function(data){
    logger.debuglog('all ok : ' + 'init() start : ' + data.init + ' : ' + data.data + ' : ' + data.log);
  })
  .catch(function(data){
    logger.debuglog('catch : ' + 'init() start : ' + data.init + ' : ' + data.data + ' : ' + data.log);
  })
}</p>
<blockquote>
<p><code>Promise</code> 는 <code>native javascript</code> 같은데..
<code>jQuery</code> 에는 비슷한 역할을 하는 <code>Deffered</code> 객체가 있다.</p>
</blockquote>
<ul>
<li><a href="https://joshua1988.github.io/web-development/javascript/promise-for-beginners/">참고자료1</a></li>
</ul>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2019-07-28 19:17:00+00:00">July 28, 2019</time></li>
        
        
          
          <li class="md-meta__item">
            
              1 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="intellij-tomcat-console-decode"><a class="toclink" href="../../../../2019/07/28/intellij-tomcat-console-decode/">IntelliJ tomcat console decode</a></h2>
<p>그냥 생각없이 tomcat 돌리면 콘솔로그가 깨져서 나온다.
idea64.exe.vmoptions 파일 마지막에 -Dfile.encoding=UTF-8 를 추가하고
intelliJ run configuration 에도  같은걸 넣어주자.</p>
<blockquote>
<p>jekyll 는 깨진 텍스트가 들어가면 그냥 오류가 나나보다...
로그를 올릴 수가 없네..
그리고 오류가 나면 디버깅할 수 없는게 큰 단점 같다..</p>
</blockquote>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2019-07-28 19:17:00+00:00">July 28, 2019</time></li>
        
        
          
          <li class="md-meta__item">
            
              1 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="spring-boot-logback"><a class="toclink" href="../../../../2019/07/28/spring-boot-%EC%9D%B4%EA%B2%83%EC%A0%80%EA%B2%83/">Spring Boot 에서 Logback 의존성</a></h2>
<p><code>Spring Boot</code> 에서 <code>Logback</code> 을 사용하기 위해서는</p>
<p _="%" endhighlight="endhighlight">{% highlight xml %}
<groupId>org.springframework.boot</groupId>
<artifactId>spring-boot-starter-logging</artifactId></p>
<p>이놈이 필요한데 따로 써줄필요 없이</p>
<p _="%" endhighlight="endhighlight">{% highlight xml %}
<groupId>org.springframework.boot</groupId>
<artifactId>spring-boot-starter-web</artifactId></p>
<p>내부의</p>
<p _="%" endhighlight="endhighlight">{% highlight xml %}
<groupId>org.springframework.boot</groupId>
<artifactId>spring-boot-starter</artifactId></p>
<p>에 들어가있다.</p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2019-07-28 00:00:00+00:00">July 28, 2019</time></li>
        
        
          
          <li class="md-meta__item">
            
              1 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="travis"><a class="toclink" href="../../../../2019/07/28/travis-%EA%B0%80-%EB%AD%90%EC%A7%80/">Travis 가 뭐지</a></h2>
<ul>
<li><a href="https://travis-ci.com/">공식페이지</a></li>
<li><a href="https://docs.travis-ci.com/user/tutorial/">공식문서</a></li>
</ul>
<p><code>Git hub</code> 에서 관리되는 오픈소스형 CI 툴 인 것 같다. 불확실한 현실에 불실한 지식이라..
<code>.travis.yml</code> 로 프로젝트 CI 관리를 한다. (<code>ant</code> 는 <code>build.xml</code> 이었지 아마?)</p>
<blockquote>
<p>Travis.com 과 Travis.org 의 차이는 상업용도냐 아니냐의 차이였다는데</p>
<p>2018년 이후로는 .com 만 사용한다더라</p>
</blockquote>
<p><a href="https://devops.stackexchange.com/questions/1201/whats-the-difference-between-travis-ci-org-and-travis-ci-com">.com 과 .org 의 차이점</a></p>
<p>그냥 오픈소스 자동 빌드툴로만 사용하고있어서 아직 딱히 적을 것도 없다.
<code>.travis.yml</code> 설정파일을 <code>repository</code> 최상단에 추가하고 <a href="https://travis-ci.com/">공식페이지</a> 에 가서 연결해주는 것만 하면 <code>Github</code> 에 <code>push</code> 할 때마다 설정에 적힌대로 <code>build</code> 를 한다.</p>
<p>배포도 할 수 있는 것 같은데 딱히 아직 배포할 일이 없어서..</p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2019-07-28 00:00:00+00:00">July 28, 2019</time></li>
        
        
          
          <li class="md-meta__item">
            
              1 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="gitflow"><a class="toclink" href="../../../../2019/07/28/gitflow-%EA%B0%80-%EB%AD%90%EC%A7%80/">GitFlow 가 뭐지</a></h2>
<p><img alt="gitflow image" src="/assets\images\posts\2019-07-28-gitflow-01.png" /></p>
<ul>
<li>master : 제품으로 출시될 수 있는 브랜치</li>
<li>develop : 다음 출시 버전을 개발하는 브랜치<ul>
<li>feature : 기능을 개발하는 브랜치</li>
<li>release : 이번 출시 버전을 준비하는 브랜치</li>
</ul>
</li>
<li>hotfix : 출시 버전에서 발생한 버그를 수정 하는 브랜치</li>
</ul>
<blockquote>
<p>master 에서 버그가 생기면 develop 를 만들고 버그를 수정한다.
develop 에서 새로운 기능추가가 필요하면 feature 를 만들어서 기능추가를 한다.
기능추가가 완료되면 feature 를 develop 로 merge 한다.
모든 버그 수정/기능추가가 완료된 develop 에서 release 를 만들고 QA 를 진행한다.
QA 중 나온 버그들을 release 에서 수정한다.
QA 가 끝나면 release 를 master/develop 에 merge 한다.
master 에 tag 를 단다.</p>
</blockquote>
<ul>
<li><a href="https://nvie.com/posts/a-successful-git-branching-model/">참고자료1 - 영문링크</a> 와</li>
<li><a href="http://woowabros.github.io/experience/2017/10/30/baemin-mobile-git-branch-strategy.html">참고자료2 - 우형링크</a> 를 보았다.</li>
</ul>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2019-07-25 00:00:00+00:00">July 25, 2019</time></li>
        
        
          
          <li class="md-meta__item">
            
              1 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="scss"><a class="toclink" href="../../../../2019/07/25/scss-%EA%B0%80-%EB%AD%90%EC%A7%80/">SCSS 가 뭐지..</a></h2>
<blockquote>
<p>CSS (Cascading Style Sheets (CSS))
SASS (Syntactically Awesome Style Sheets)
SCSS (Sassy CSS)</p>
</blockquote>
<p><code>CSS</code> 에서 사용하기 불편한 중복이나 반복구문을 없애기 위한 전처리기<code>CSS Preprocessor</code>이다.</p>
<p><code>Sass(Syntactically Awesome Style Sheets)</code>, <code>Less</code>, <code>Stylus</code> 같은 애들이 있는데, 뭐 있다는 것만 알고
아무튼 각자 편한 문법으로 작성한 뒤, <code>Compile</code> 하여 <code>CSS</code> 를 만들어준다.</p>
<p><code>Github page</code> <code>theme</code> 때문에 <code>SCSS</code> 를 쓰게 됐는데</p>
<pre><code class="language-scss">.pure-table {
  border-collapse: collapse;
  border-spacing: 0;
  empty-cells: show;
  border: 1px solid #cbcbcb;
  thead {
    background-color: #e0e0e0;
    color: #000;
    text-align: left;
    vertical-align: bottom;
  }
  th, td {
    padding: 0.5em 1em;
    border-left: 1px solid #cbcbcb;
    font-size: inherit;
    margin: 0;
    overflow: visible;
  }
  td {
    background-color: transparent;
  }
}
</code></pre>
<h4 id="less-stylus-scss"><a class="toclink" href="../../../../2019/07/25/scss-%EA%B0%80-%EB%AD%90%EC%A7%80/#less-stylus-scss">난 <code>Less</code> 도 모르고 <code>Stylus</code> 도 몰라. 그냥 <code>SCSS</code> 만 쓰고 있는데, 다 알아야하나?</a></h4>
<p>문법은 <code>Sass</code> 가 <code>Stylus</code> 와 비슷하고, <code>SCSS</code> 는 <code>Less</code> 와 비슷하다.
<code>Sass</code> 와 <code>SCSS</code> 는 하나의 컴파일러로 모두 컴파일 가능하다.</p>
<p><code>Sass</code> 의 3버전에서 새롭게 등장한 <code>SCSS</code> 는 <code>Sass</code> 의 모든 기능을 지원하는 <code>CSS</code> 의 상위집합(Superset) 이다.
둘의 가장 큰 차이는 <code>{bracket}</code> 과 <code>semicolon;</code> 의 유무다.</p>
<blockquote>
<p>정말 귀찮아서 예제는 퍼왔습니다. 죄송해요!</p>
</blockquote>
<pre><code class="language-sass">.list
width: 100px
float: left
li
  color: red
  background: url(&quot;./image.jpg&quot;)
  &amp;:last-child
    margin-right: -10px
</code></pre>
<pre><code class="language-scss">.list {
  width: 100px;
  float: left;
  li {
    color: red;
    background: url(&quot;./image.jpg&quot;);
    &amp;:last-child {
      margin-right: -10px;
    }
  }
}
</code></pre>
<blockquote>
<p>으어 더 찾아보기 귀찮다.</p>
</blockquote>
<p>출처
- <a href="https://heropy.blog/2018/01/31/sass/">Sass(SCSS) 완전 정복!</a></p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2019-07-25 00:00:00+00:00">July 25, 2019</time></li>
        
        
          
          <li class="md-meta__item">
            
              5 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="_1"><a class="toclink" href="../../../../2019/07/25/git-rebase/">빠른사용</a></h2>
<p>자세한 설명은 아래쪽에..</p>
<h3 id="rebase-squash"><a class="toclink" href="../../../../2019/07/25/git-rebase/#rebase-squash">rebase 를 사용해서 커밋을 합치고(squash) 싶다.</a></h3>
<p>현재 상황 develop-temp branch 에서 작업중인데, 작업했던 것을 다 합치고 싶다.</p>
<pre><code class="language-shell">$ git log --oneline -5
13e4685 (HEAD -&gt; develop-temp) add 1, 1, 2, 3
99285be add c
935b826 done code01
0222a9e (origin/develop, test, develop) done code01
fa30853 code01 dev..
</code></pre>
<p><code>-i</code> interactive 모드 와 <code>HEAD~3</code>  HEAD 를 포함한 3개까지의 commit 을 합친다.</p>
<pre><code class="language-shell">$ git rebase -i HEAD~3
</code></pre>
<p>그럼 편집기가 열리면서 요딴식으로 나오는데..</p>
<pre><code class="language-shell">pick 935b826 done code01
pick 99285be add c
pick 13e4685 add 1, 1, 2, 3

</code></pre>
<p>그걸 아래와 같이 고친다. squash 는 이전 commit 에 이후 commit 을 녹이는 작업이다. 그래서 이전 commit 이 없으면 안된다.<br />
pick -&gt; s 로 고침. s 는 squash 를 의미. 저렇게 고치고나서 <code>:wq</code> 로 저장 후 나가면..</p>
<blockquote>
<p>squash <commit> = use commit, but meld into previous commit</p>
</blockquote>
<p>``` # 커밋 3개가 섞인 결과입니다.</p>
<h2 id="1"><a class="toclink" href="../../../../2019/07/25/git-rebase/#1">1번째 커밋 메시지입니다:</a></h2>
<p>done code01, add c, d, 1, 1, 2, 3</p>
<h2 id="2"><a class="toclink" href="../../../../2019/07/25/git-rebase/#2">커밋 메시지 #2번입니다:</a></h2>
<h2 id="3"><a class="toclink" href="../../../../2019/07/25/git-rebase/#3">커밋 메시지 #3번입니다:</a></h2>
<p>shell
pick 935b826 done code01
s 99285be add c
s 13e4685 add 1, 1, 2, 3</p>
<pre><code>
로그를 어떻게 수정할 건지 물어보는 편집기가 또 열린다.

``` shell
# 커밋 3개가 섞인 결과입니다.
# 1번째 커밋 메시지입니다:

done code01

1

2

# 커밋 메시지 #2번입니다:

add c

add d

# 커밋 메시지 #3번입니다:

add 1, 1, 2, 3


</code></pre>
<p>잘고쳐준 뒤, 마찬가지로 <code>:wq</code> 로 저장 후 종료하면..</p>
<pre><code class="language-shell"># 커밋 3개가 섞인 결과입니다.
# 1번째 커밋 메시지입니다:

done code01, add c, d, 1, 1, 2, 3

# 커밋 메시지 #2번입니다:



# 커밋 메시지 #3번입니다:



</code></pre>
<p>합쳐진것을 확인할 수 있다.</p>
<pre><code class="language-shell">git log --oneline -5
0032bd9 (HEAD -&gt; develop-temp) done code01, add c, d, 1, 1, 2, 3
0222a9e (origin/develop, test, develop) done code01
fa30853 code01 dev..
</code></pre>
<h3 id="rebase"><a class="toclink" href="../../../../2019/07/25/git-rebase/#rebase">rebase 를 사용해 커밋 메세지를 수정하고 싶다.</a></h3>
<p>현재 상황.. done code01, add c, d, 1, 1, 2, 3 -&gt; 이 커밋 내용을 심플하게 done! 으로 바꾸고싶다.</p>
<pre><code class="language-shell">$ git log --oneline -5
0032bd9 (HEAD -&gt; develop-temp) done code01, add c, d, 1, 1, 2, 3
0222a9e (origin/develop, test, develop) done code01
fa30853 code01 dev..
</code></pre>
<p>커밋 메세지만 수정할거니까.. <code>-i</code> interactive 모드 와 <code>HEAD~1</code>  HEAD 를 포함한 1개의 commit 을 수정한다.</p>
<pre><code class="language-shell">$ git rebase -i HEAD~1
</code></pre>
<p>그럼 아래와 같이 편집기가 열린다.</p>
<pre><code class="language-shell">pick 0032bd9 done code01, add c, d, 1, 1, 2, 3
</code></pre>
<p><code>r</code> reword 로 마킹하고 <code>:wq</code> 로 저장 후 종료하면..</p>
<pre><code class="language-shell">r 0032bd9 done code01, add c, d, 1, 1, 2, 3
</code></pre>
<p>마찬가지로 커밋 메세지를 수정할 수 있는 편집기가 열린다.</p>
<pre><code class="language-shell">done code01, add c, d, 1, 1, 2, 3 
</code></pre>
<p>done! 으로 수정한 뒤, <code>:wq</code> 저장 후 종료한뒤, 확인해보자.</p>
<pre><code class="language-shell">$ git log --oneline -5
d34433f (HEAD -&gt; develop-temp) done!
0222a9e (origin/develop, test, develop) done code01
fa30853 code01 dev..
</code></pre>
<hr />
<h2 id="rebase_1"><a class="toclink" href="../../../../2019/07/25/git-rebase/#rebase_1"><code>rebase</code></a></h2>
<p>~~이미 커밋한 히스토리를 수정할 떄 사용한다.~~ 완전 잘못 이해했었음.</p>
<p>branch 의 parent 를 변경할 떄 사용.</p>
<p>히스토리를 수정하거나 커밋을 합치는것은 부가적인 기능이다.</p>
<pre><code class="language-shell">$ git checkout -b feature-a
$ .... working....
# feature-a branch 의 부모를 master 로 변경한다. 
$ git rebase master
</code></pre>
<h3 id="-i-interactive"><a class="toclink" href="../../../../2019/07/25/git-rebase/#-i-interactive"><code>-i</code>, <code>--interactive</code></a></h3>
<p>대화형으로 rebase 실행한다.</p>
<p>대화형으로 커밋을 수정할때, 아래와 같은 방법들이 있다.</p>
<h4 id="pick-p"><a class="toclink" href="../../../../2019/07/25/git-rebase/#pick-p">pick, p</a></h4>
<p>커밋 순서를 변경한다.</p>
<p>현재 커밋상태</p>
<pre><code class="language-shell">$ git log --oneline
ab1b2e7 (HEAD -&gt; feature-03) feature33
61840bc feature32
4b6dff3 feature31
b71edbe feature03
511a2a0 feature03
a165c9b feature3
07cfb82 fix bug3
dd2c2a5 Merge branch 'master' into develop
53299fd (master) hotfix1-1,1-2,1-3,1,1-2
888c443 fix bug1
b053989 fix bug02
2ca8e8b fix bug01
c12791f (origin/master) add main
</code></pre>
<p>commit feature32 와 feature33 의 커밋 순서를 바꿔본다.<br />
에디팅 모드에서 단순하게 커밋위치를 변경하면된다.</p>
<pre><code class="language-shell">$ git rebase -i HEAD~4

pick b71edbe feature03
pick 4b6dff3 feature31
pick ab1b2e7 feature33
pick 61840bc feature32
</code></pre>
<p>확인해보면,</p>
<pre><code class="language-shell">$ git log --oneline
92efb5b (HEAD -&gt; feature-03) feature32
03b4863 feature33
4b6dff3 feature31
b71edbe feature03
511a2a0 feature03
a165c9b feature3
07cfb82 fix bug3
dd2c2a5 Merge branch 'master' into develop
53299fd (master) hotfix1-1,1-2,1-3,1,1-2
888c443 fix bug1
b053989 fix bug02
2ca8e8b fix bug01
c12791f (origin/master) add main
</code></pre>
<h4 id="reword-r"><a class="toclink" href="../../../../2019/07/25/git-rebase/#reword-r">reword, r</a></h4>
<p>커밋 메세지를 변경한다.</p>
<p>현재 커밋상태</p>
<pre><code class="language-shell">$ git log --oneline --graph
* e810ee0 (HEAD -&gt; master) hotfix1-3
* f1e5097 hotfix1-2
* 050139b hotfix1-1
* c12791f (origin/master) add main
</code></pre>
<p>그냥 <code>git rebase</code> 를 입력하면 커밋을 순서대로 보여준다.</p>
<pre><code class="language-shell">$ git rebase
First, rewinding head to replay your work on top of it...
Applying: hotfix1-1
Applying: hotfix1-2
Applying: hotfix1-3
</code></pre>
<p><code>git rebase -i</code> 옵션으로 실행하면 에디터 창이 뜬다.
<code>git rebase -i HEAD~2</code> HEAD 포함하여 2개의 커밋을 대상으로 한다.</p>
<pre><code class="language-shell">$ git rebase -i

pick 050139b hotfix1-1
pick f1e5097 hotfix1-2
pick e810ee0 hotfix1-3

# Rebase c12791f..e810ee0 onto c12791f (3 commands)
#
# Commands:
# p, pick &lt;commit&gt; = use commit
# r, reword &lt;commit&gt; = use commit, but edit the commit message
# e, edit &lt;commit&gt; = use commit, but stop for amending
# s, squash &lt;commit&gt; = use commit, but meld into previous commit
# f, fixup &lt;commit&gt; = like &quot;squash&quot;, but discard this commit's log message
# x, exec &lt;command&gt; = run command (the rest of the line) using shell
# b, break = stop here (continue rebase later with 'git rebase --continue')
# d, drop &lt;commit&gt; = remove commit
# l, label &lt;label&gt; = label current HEAD with a name
# t, reset &lt;label&gt; = reset HEAD to a label
# m, merge [-C &lt;commit&gt; | -c &lt;commit&gt;] &lt;label&gt; [# &lt;oneline&gt;]
# .       create a merge commit using the original merge commit's
# .       message (or the oneline, if no original merge commit was
# .       specified). Use -c &lt;commit&gt; to reword the commit message.
#
# These lines can be re-ordered; they are executed from top to bottom.
#
# If you remove a line here THAT COMMIT WILL BE LOST.
#
# However, if you remove everything, the rebase will be aborted.
#
# Note that empty commits are commented out
</code></pre>
<p>기본적으로 <code>pick</code> 커맨드가 적용이 되어있다. 따라서 그냥 <code>:wq</code>  하면 아무런 변경사항 없이 종료된다.</p>
<pre><code class="language-shell">pick 050139b hotfix1-1
reword f1e5097 hotfix1-2
pick e810ee0 hotfix1-3
</code></pre>
<p><code>r</code> 또는 <code>reword</code> 커맨드를 사용하면(에디팅 모드에서 pick 으로 되어있는 것을 지우고, r 또는 reword 를 입력하고, :wq 로 저장하고 나가면) 커밋 메세지를 수정할 수 있는 에디터가 열린다.</p>
<pre><code class="language-shell">hotfix1-2-mod-from-rebase

# Please enter the commit message for your changes. Lines starting
# with '#' will be ignored, and an empty message aborts the commit.
#
# date:
  created:      Tue Jul 9 20:50:06 2019 +0900
#
# interactive rebase in progress; onto c12791f
# Last commands done (2 commands done):
#    pick 050139b hotfix1-1
#    reword f1e5097 hotfix1-2
# Next command to do (1 remaining command):
#    pick e810ee0 hotfix1-3
# You are currently editing a commit while rebasing branch 'master' on 'c12791f'.
#
# Changes to be committed:
#       modified:   hotfix-01
</code></pre>
<p>수정한뒤, <code>hotfix1-2</code> -&gt; <code>hotfix1-2-mod-from-rebase</code> <code>:wq</code> 로 저장후 종료하면</p>
<pre><code class="language-shell">$ git log --oneline --graph
* 91db62d (HEAD -&gt; master) hotfix1-3
* 1159e30 hotfix1-2-mod-from-rebase
* 050139b hotfix1-1
* c12791f (origin/master) add main
</code></pre>
<p>커밋 메세지가 변경된다.</p>
<h2 id="squash"><a class="toclink" href="../../../../2019/07/25/git-rebase/#squash">squash</a></h2>
<p>커밋을 합친다.</p>
<p>현재 커밋 상태.</p>
<p><code>hotfix-1</code> 에서 수정을 여러번 했고 그게 그대로 <code>master</code> 에 편입되어 메세지가 더러운 상태다.</p>
<blockquote>
<p>master 에서 hotfix-1 hotfix-2 hotfix-3 중에서 hotfix-1 이 merge 되었고,
rebase 로 커밋메세지를 변경한다음 hotfix-1 에서 추가 수정을 한 뒤,
또 merge 하니까 이런 모양새가 되었다.</p>
</blockquote>
<pre><code class="language-shell">$ git log --oneline --graph
*   8386aa9 (HEAD -&gt; master, hotfix-3, hotfix-2) Merge branch 'hotfix-1'
|\
| * 2794231 hotfix1-2
| * ba77a63 hotfix1
| * fc03e1e hotfix1
| * acd1ed5 hotfix1
* | 91db62d hotfix1-3
* | 1159e30 hotfix1-2-mod-from-rebase
* | 050139b hotfix1-1
|/
* c12791f (origin/master) add main
</code></pre>
<p>쫙 다 합쳐보겠다.</p>
<pre><code class="language-shell">$ git rebase -i

p 050139b hotfix1-1
squash 1159e30 hotfix1-2-mod-from-rebase
s 91db62d hotfix1-3
s acd1ed5 hotfix1
s fc03e1e hotfix1
s ba77a63 hotfix1
s 2794231 hotfix1-2
</code></pre>
<pre><code class="language-shell">$ git log --oneline --graph
* 53299fd (HEAD -&gt; master) hotfix1-1,1-2,1-3,1,1-2
* c12791f (origin/master) add main
</code></pre>
<h2 id="-abort"><a class="toclink" href="../../../../2019/07/25/git-rebase/#-abort">--abort</a></h2>
<p>현재 rebase 상태를 취소한다.</p>
<h2 id="conflict"><a class="toclink" href="../../../../2019/07/25/git-rebase/#conflict">conflict 가 났을때</a></h2>
<h3 id="_2"><a class="toclink" href="../../../../2019/07/25/git-rebase/#_2">직접 수정하기</a></h3>
<pre><code class="language-shell"># 직접 파일에가서 conflict 를 수정한뒤, status 로 conflict 파일을 확인하여 add 한다
$ git status
$ git add {conflict resolved file}
$ git rebase --continue
</code></pre>
<h3 id="_3"><a class="toclink" href="../../../../2019/07/25/git-rebase/#_3">내것/남에것으로 엎어치기</a></h3>
<p>rebase conflict 가 나면, git status 를 했을 때, conflict 된 파일이 stage 에 들어가지 않게 된다.</p>
<p>해당 파일을 수정하고 stage 로 넣은 뒤, 메세지에 나온대로 <code>git rebase --continue</code> 로 rebase 를 완료하면 된다.</p>
<p>conflict 난 파일을 수정할 때,</p>
<p>내가 branch 이고, master 를 기준으로 rebase 할때 참고
* <code>git checkout --ours &lt;FILE-NAME&gt;</code> master 수정본을 사용하여 덮어쓰기
* <code>git checkout --theirs &lt;FILE-NAME&gt;</code> branch 수정본을 사용하여 덮어쓰기</p>
<hr />
<h2 id="_4"><a class="toclink" href="../../../../2019/07/25/git-rebase/#_4">참고</a></h2>
<ul>
<li><a href="https://git-scm.com/book/ko/v2/Git-%EB%B8%8C%EB%9E%9C%EC%B9%98-Rebase-%ED%95%98%EA%B8%B0">3.6 Git 브랜치 - Rebase 하기</a></li>
</ul>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2019-07-25 00:00:00+00:00">July 25, 2019</time></li>
        
        
          
          <li class="md-meta__item">
            
              2 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="reset"><a class="toclink" href="../../../../2019/07/25/git-reset/"><code>reset</code></a></h2>
<p><code>commit</code> 을 되돌린다. 옵션에 따라 되돌리는 정도가 달라진다.
* HEAD가 가리키는 브랜치를 옮긴다. (--soft)
* Index를 HEAD가 가리키는 상태로 만든다. (--hard 옵션이 붙지 않았으면 여기까지)
* 워킹 디렉토리를 Index의 상태로 만든다. (--hard)</p>
<h3 id="-soft-commit"><a class="toclink" href="../../../../2019/07/25/git-reset/#-soft-commit"><code>--soft &lt;COMMIT&gt;</code></a></h3>
<p><code>index</code> 와 <code>working directory</code> 를 되돌리지 않고, 현재 <code>branch</code> 가 가리키는 <code>commit</code> 만 <code>&lt;COMMIT&gt;</code> 으로 변경한다.</p>
<blockquote>
<p><code>commit</code> 만 되돌린다. 수정사항이 add 되어 <code>staging area</code> 에 들어가 있다. <code>commit</code> 만 다시 하면 되는 상황.<br />
<code>git commit --amend</code> 명령과 동일하다</p>
</blockquote>
<p>현재 로그</p>
<pre><code class="language-shell">* a777c69 (HEAD -&gt; master) 2
* b6f3a87 reset study 2
* 876933d reset study 1
* 9de2bfa (origin/master, origin/HEAD) start again
*   15ac3cf merge conflit
|\
| * 237da11 mod text
* | 241c8af mod text2
|/
* 942209d (tag: v1.0) add line
* 2936c11 init commit
</code></pre>
<pre><code class="language-shell">$ git reset --soft HEAD~
$ git log --oneline --graph
* b6f3a87 (HEAD -&gt; master) reset study 2
* 876933d reset study 1
* 9de2bfa (origin/master, origin/HEAD) start again
*   15ac3cf merge conflit
|\
| * 237da11 mod text
* | 241c8af mod text2
|/
* 942209d (tag: v1.0) add line
* 2936c11 init commit
</code></pre>
<h3 id="-mixed-commit"><a class="toclink" href="../../../../2019/07/25/git-reset/#-mixed-commit"><code>--mixed &lt;COMMIT&gt;</code></a></h3>
<p><code>reset --soft &lt;COMMIT&gt;</code> 상태에서 <code>staging area</code> 비운다.</p>
<blockquote>
<p><code>commit</code> 과 <code>add</code> 를 되돌린다. 다시 <code>add</code> 한 다음, <code>commit</code> 해야한다.</p>
</blockquote>
<h3 id="-hard-commit"><a class="toclink" href="../../../../2019/07/25/git-reset/#-hard-commit"><code>--hard &lt;COMMIT&gt;</code></a></h3>
<p><code>reset --mixed &lt;COMMIT&gt;</code> 상태에서 <code>working directory</code> 도 변경한다.</p>
<h3 id="squash"><a class="toclink" href="../../../../2019/07/25/git-reset/#squash">합치기(Squash)</a></h3>
<p>커밋을 합치는 명령어가 있지만, reset 을 사용해서 더 간단하게 할 수도 있다.</p>
<p><code>reset --soft</code> 로 HEAD 만 이동한뒤, commit 을 하면 된다.</p>
<pre><code class="language-shell">$ git log --oneline
d22f009 (HEAD -&gt; master) add 02 03
a23d46f 03 mod mod
1bf2e15 02
299211c (origin/master) add code01

$ git reset --soft HEAD~2

$ git commit -m &quot;03 mod mod, add 02 03&quot;

$ git log --oneline
49bf8b2 (HEAD -&gt; master) 03 mod mod, add 02 03
1bf2e15 02
299211c (origin/master) add code01
</code></pre>
<h3 id="reset-checkout"><a class="toclink" href="../../../../2019/07/25/git-reset/#reset-checkout"><code>reset</code> 과 <code>checkout</code> 의 차이?</a></h3>
<p><code>git checkout [branch]</code> 와 <code>git reset --hard [branch]</code> 는 비슷해 보인다.
실제 결과도 비슷하다. 하지만, 중요한 차이점이 있다.</p>
<ol>
<li><code>checkout</code> 은 워킹 디렉토리를 안전하게 다룬다. <code>reset</code> 처럼 변경사항을 무시하지 않는다. 아직 commit 되지 않은 변경사항이 있으면 checkout 으로 branch 를 변경하지 못하게 막는다.  그에 반해 <code>reset</code> 은 확인하지않고 바꿔버린다.</li>
<li>checkout 은 HEAD 자체를 다른 branch 로 옮기지만, reset 은 HEAD 가 가르키는 branch 를 움직인다. (다른 commit 을 가르키도록)</li>
</ol>
<h3 id="_1"><a class="toclink" href="../../../../2019/07/25/git-reset/#_1">하나 더</a></h3>
<p><code>git reflog</code> 를 실행하면, git 으로 명령 내린 것들이 로그처럼 나온다.
<code>git reset HEAD@{index}</code> 를 사용해 이전으로 돌아갈 수 있다.</p>
<p>참고
- <a href="https://git-scm.com/book/ko/v2/Git-%EB%8F%84%EA%B5%AC-Reset-%EB%AA%85%ED%99%95%ED%9E%88-%EC%95%8C%EA%B3%A0-%EA%B0%80%EA%B8%B0">7.7 Git 도구 - Reset 명확히 알고 가기</a></p>
    
  </div>
</article>
      
      
        
          



<nav class="md-pagination">
  <a class="md-pagination__link" href="../../">1</a> <span class="md-pagination__dots">..</span> <a class="md-pagination__link" href="../5/">5</a> <a class="md-pagination__link" href="../6/">6</a> <span class="md-pagination__current">7</span> <a class="md-pagination__link" href="../8/">8</a>
</nav>
        
      
    </div>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../../..", "features": [], "search": "../../../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": {"Compatibility": "compat", "rabbitmq": "rabbitmq"}, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.f13b1293.min.js"></script>
      
    
  </body>
</html>